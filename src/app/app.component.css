:host {
  --bg: #0a0a0f;
  --surface: #12121a;
  --x-color: #ff4d6d;
  --x-dim: #5a1a25;
  --o-color: #4dffb8;
  --o-dim: #1a5a3f;
  --grid-line: #2a2a3a;
  --text: #e8e8f0;
  --muted: #5a5a7a;
  --ghost: rgba(255,255,255,0.06);
}

.wrapper {
  position: relative;
  z-index: 1;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  min-height: 100vh;
  gap: 24px;
  padding: 20px;
  width: 100%;
  box-sizing: border-box;
}

/* Title */
.title {
  font-family: 'Bebas Neue', sans-serif;
  font-size: clamp(2rem, 6vw, 3.5rem);
  letter-spacing: 0.08em;
  line-height: 1;
  text-align: center;
}
.title span:first-child { color: var(--x-color); }
.title span:last-child { color: var(--o-color); }
.title .slash { color: var(--muted); margin: 0 4px; }

.subtitle {
  font-size: 0.7rem;
  letter-spacing: 0.2em;
  color: var(--muted);
  text-transform: uppercase;
  text-align: center;
  margin-top: 4px;
}

/* Status bar */
.status-bar {
  display: flex;
  align-items: center;
  gap: 16px;
  background: var(--surface);
  border: 1px solid var(--grid-line);
  border-radius: 4px;
  padding: 10px 20px;
  min-width: 280px;
  justify-content: center;
}

.player-indicator {
  display: flex;
  align-items: center;
  gap: 8px;
  font-size: 0.75rem;
  letter-spacing: 0.15em;
  text-transform: uppercase;
  color: var(--muted);
  transition: all 0.3s;
}
.player-indicator.active { color: var(--text); }
.player-indicator .symbol {
  font-family: 'Bebas Neue', sans-serif;
  font-size: 1.4rem;
  line-height: 1;
  transition: all 0.3s;
}
.player-indicator.x-ind .symbol { color: var(--x-dim); }
.player-indicator.x-ind.active .symbol {
  color: var(--x-color);
  text-shadow: 0 0 20px rgba(255,77,109,0.6);
}
.player-indicator.o-ind .symbol { color: var(--o-dim); }
.player-indicator.o-ind.active .symbol {
  color: var(--o-color);
  text-shadow: 0 0 20px rgba(77,255,184,0.6);
}
.divider { color: var(--grid-line); font-size: 1.4rem; }

.turn-label {
  font-size: 0.65rem;
  letter-spacing: 0.2em;
  color: var(--muted);
}

/* Move counters */
.move-dots {
  display: flex;
  gap: 4px;
  margin-top: 4px;
}
.move-dot {
  width: 6px;
  height: 6px;
  border-radius: 50%;
  border: 1px solid currentColor;
  opacity: 0.3;
  transition: all 0.3s;
}
.move-dot.filled { opacity: 1; background: currentColor; }
.move-dot.danger { animation: pulse-dot 0.8s ease-in-out infinite; }

.x-ind .move-dot { color: var(--x-color); }
.o-ind .move-dot { color: var(--o-color); }

@keyframes pulse-dot {
  0%, 100% { transform: scale(1); opacity: 1; }
  50% { transform: scale(1.4); opacity: 0.7; }
}

/* Board */
.board {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 3px;
  background: var(--grid-line);
  border: 3px solid var(--grid-line);
  border-radius: 6px;
  overflow: hidden;
  position: relative;
}

.board-row {
  display: contents;
}

.cell {
  width: clamp(90px, 22vw, 120px);
  height: clamp(90px, 22vw, 120px);
  background: var(--surface);
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  position: relative;
  transition: background 0.15s;
  overflow: hidden;
  border: none;
  outline: none;
}

.cell:hover:not(.taken) {
  background: var(--ghost);
}
.cell:hover:not(.taken)::after {
  content: attr(data-preview);
  font-family: 'Bebas Neue', sans-serif;
  font-size: 3rem;
  opacity: 0.15;
  position: absolute;
  color: var(--text);
}

.cell.taken { cursor: default; }

/* Piece rendering */
.piece {
  font-family: 'Bebas Neue', sans-serif;
  font-size: clamp(2.5rem, 8vw, 3.8rem);
  position: absolute;
  transition: all 0.35s cubic-bezier(0.34, 1.56, 0.64, 1);
  user-select: none;
  line-height: 1;
}

.piece.x-piece {
  color: var(--x-color);
  text-shadow: 0 0 30px rgba(255,77,109,0.5);
}
.piece.o-piece {
  color: var(--o-color);
  text-shadow: 0 0 30px rgba(77,255,184,0.5);
}

/* Age states */
.piece.age-0 { opacity: 1; transform: scale(1); }
.piece.age-1 { opacity: 0.75; transform: scale(0.9); }
.piece.age-2 { opacity: 0.45; transform: scale(0.78); }

/* Move order badge */
.move-badge {
  position: absolute;
  bottom: -18px;
  right: -12px;
  font-size: 0.5rem;
  letter-spacing: 0.1em;
  opacity: 0.4;
  font-family: 'DM Mono', monospace;
  color: var(--muted);
}
.age-0 .move-badge { opacity: 0.7; }

/* Win cell highlight */
.cell.win-cell { background: rgba(255,255,255,0.04); }

/* Win strike line */
.win-line-overlay {
  position: absolute;
  inset: 0;
  pointer-events: none;
  z-index: 10;
}
.win-line {
  position: absolute;
  height: 4px;
  border-radius: 2px;
  transform-origin: left center;
  animation: win-strike 0.5s ease-out forwards;
  box-shadow: 0 0 12px 2px currentColor;
}
@keyframes win-strike {
  0% { opacity: 0; clip-path: inset(0 100% 0 0); }
  60% { opacity: 1; }
  100% { opacity: 0.85; clip-path: inset(0 0 0 0); }
}

/* Scores */
.scores {
  display: flex;
  gap: 20px;
  font-size: 0.65rem;
  letter-spacing: 0.2em;
  color: var(--muted);
  text-transform: uppercase;
}
.score-item {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 4px;
}
.score-num {
  font-family: 'Bebas Neue', sans-serif;
  font-size: 1.8rem;
  line-height: 1;
}
.score-item.x-score .score-num { color: var(--x-color); }
.score-item.o-score .score-num { color: var(--o-color); }
.score-item.tie-score .score-num { color: var(--muted); }
.score-sep {
  color: var(--grid-line);
  align-self: center;
  font-size: 1.2rem;
}

/* Rules */
.rules {
  font-size: 0.62rem;
  letter-spacing: 0.12em;
  color: var(--muted);
  text-align: center;
  line-height: 1.8;
  text-transform: uppercase;
}
.rules strong { color: var(--text); }

/* Result overlay */
.result-overlay {
  position: fixed;
  inset: 0;
  background: rgba(10,10,15,0.85);
  backdrop-filter: blur(8px);
  z-index: 100;
  display: flex;
  align-items: center;
  justify-content: center;
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.4s;
}
.result-overlay.show {
  opacity: 1;
  pointer-events: all;
}

.result-card {
  background: var(--surface);
  border: 1px solid var(--grid-line);
  padding: 40px 60px;
  text-align: center;
  border-radius: 6px;
  transform: scale(0.85);
  transition: transform 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
  position: relative;
  overflow: hidden;
}
.result-overlay.show .result-card { transform: scale(1); }

.result-card::before {
  content: '';
  position: absolute;
  inset: 0;
  opacity: 0.05;
  pointer-events: none;
  border-radius: 6px;
}

.result-winner {
  font-family: 'Bebas Neue', sans-serif;
  font-size: 4rem;
  line-height: 1;
  text-shadow: 0 0 40px var(--winner-color, transparent);
  animation: winner-pulse 1s ease-in-out infinite alternate;
}
@keyframes winner-pulse {
  from { text-shadow: 0 0 20px var(--winner-color, transparent); }
  to { text-shadow: 0 0 60px var(--winner-color, transparent), 0 0 100px var(--winner-color, transparent); }
}

.result-label {
  font-size: 0.7rem;
  letter-spacing: 0.25em;
  color: var(--muted);
  text-transform: uppercase;
  margin-top: 8px;
  margin-bottom: 28px;
}

.restart-btn {
  background: transparent;
  border: 1px solid var(--grid-line);
  color: var(--text);
  font-family: 'DM Mono', monospace;
  font-size: 0.7rem;
  letter-spacing: 0.2em;
  text-transform: uppercase;
  padding: 12px 28px;
  cursor: pointer;
  transition: all 0.2s;
  border-radius: 3px;
  position: relative;
  z-index: 10;
}
.restart-btn:hover {
  background: var(--ghost);
  border-color: var(--text);
}

/* Mobile responsiveness */
@media (max-width: 400px) {
  .wrapper { gap: 16px; padding: 12px; }
  .status-bar { padding: 8px 12px; gap: 10px; min-width: auto; }
  .cell {
    width: clamp(75px, 26vw, 100px);
    height: clamp(75px, 26vw, 100px);
  }
  .result-card { padding: 30px 40px; }
  .result-winner { font-size: 3rem; }
}
